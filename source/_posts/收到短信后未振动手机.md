---
title: 收到短信后未振动手机
date: 2017-09-22 13:25:09
tags:
---
packages/apps/Mms/src/com/android/mms/transaction/MessagingNotification.java
``` Java
updateNotification(){
	...
    /// M:Code analyze 014, for brazil request, when calling still have sound @{
    int state = ((TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE)).getCallState();
    if (state != TelephonyManager.CALL_STATE_IDLE) {
        //playTone(context, ToneGenerator.TONE_SUP_DIAL);
        defaults |= Notification.DEFAULT_VIBRATE;	//添加这句代码即可
    } else {
        noti.setSound(TextUtils.isEmpty(ringtoneStr) ? null : Uri.parse(ringtoneStr));
    }
    ...
}

```